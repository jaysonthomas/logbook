
<!DOCTYPE html>
<html>
<head>
  <title>Python</title>
  <meta name="Python" content="text/html; charset=utf-8;" />
  <script type="text/javascript" src="../../logbook.js"></script>

  <script src="../../logbook-mathjax-config.js" defer></script> 
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="stylesheet" type="text/css" href="../../logbook.css" />
</head>

<body onload="loadChapter('');">  

  <div data-type="titlepage" pdf="no">
    <header>
      <h1><a href="../../index.html" style="text-decoration:none;">Logbook</a></h1>
      <p style="font-size: 18px;"><a href="../../pages/bio/jjwt.html">Jayson Wynne-Thomas</a></p>
      <p style="font-size: 14px; text-align: right;"> 
        Last modified <span id="last_modified"></span>.</br>
        <script>
        var d = new Date(document.lastModified);
        document.getElementById("last_modified").innerHTML = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();</script>
      </p>
    </header>
  </div>
  
  <div id="main" class="sidebar1">
    <span style="font-size:10px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

  <div id="mySidenav" class="sidebar">
  
<a href="#0">Pip</a>
<a href="#1">Type hinting</a>
<ul class="no-bullets">
  <li><a href="#1.0">Stub files</a></li>
</ul>
<a href="#2">Python configuration</a>
<a href="#3">Operators</a>
<a href="#4">Structure</a>
<a href="#5">List</a>
<ul class="no-bullets">
  <li><a href="#5.0">List of numpy arrays</a></li>
</ul>
<a href="#6">Python learning from Drake python api</a>
<a href="#7">Pandas</a>
<a href="#8">Numpy</a>
<a href="#9">General</a>
<a href="#10">Regular expressions</a>
<a href="#11">Lambda</a>
<a href="#12">Dictionary</a>
<a href="#13">Timing python code</a>
<a href="#14">Relationships</a>
<ul class="no-bullets">
  <li><a href="#14.0">Extension (Inheritance)</a></li>
  <li><a href="#14.1">Composition</a></li>
  <li><a href="#14.2">Aggregation</a></li>
</ul>
<a href="#15">Set</a>
<a href="#16">Musings</a>
</div>

<chapter style="counter-reset: chapter 1"><h1>Python</h1>

<section id="0"><h1>Pip</h1>
<pre><code class="python">
pip3 show drake
pip3 install drake==1.10.0  
pip3 install test.whl --force-reinstall
pip3 --version
python3.10 -m pip install ###
python3 --version
python -m pip install --upgrade pip
python -m pip install --upgrade black==23.12.1
</code></pre>
</section>

<section id="1"><h1>Type hinting</h1>
<pre><code class="python">
def greet(name: str) -> str:
  temp : str | None = "Hello"
  return temp + ", " + name
</code></pre>

  Here, <code>name</code> is of type string. The return type indicated by <code>-&gt</code> is of the same type. The variable <code>temp</code> can either be of type string or None; it is assigned the value "Hello". The output is: "Hello, " followed by the name.

  <subsection id="1.0"><h1>Stub files</h1>
    In Python, stub files with a .pyi extension are used for type hinting without providing the actual implementation code. These stub files contain type information for functions, classes, and modules, allowing static type checkers and IDEs to analyze code for potential type-related issues without the need for the full implementation.

    <p>
      For example, a module called example.py, you might have a corresponding stub file named example.pyi.
    </p>

<pre><code class="python">
# example.py
def add(x: int, y: int) -> int:
  return x + y

# example.pyi
def add(x: int, y: int) -> int: ...
</code></pre>  

    The ellipsis <code>...</code> is used to indicate that this is a stub and doesn't include the actual function implementation.
  </subsection>
</section>

<section id="2"><h1>Python configuration</h1>
  [<a href="https://t.ly/dMtsd">Ref</a>] <br>
  To see the options:
<pre><code class="bash">
sudo update-alternatives --config python
</code></pre>

  If there are no errors:
<pre><code class="bash">
update-alternatives: error: no alternatives for python3  
</code></pre>
    
  To install alternatives:
<pre><code class="bash">
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.4 1
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2  
</code></pre>
  
  To set an alternative (can also use the config option):
<pre><code class="bash">
sudo update-alternatives  --set python /usr/bin/python3.6  
</code></pre>
</section>

<section id="3"><h1>Operators</h1>
  <ul>
    <li><code>Set Union</code></li>
<pre><code class="python">
s1 = {'a', 'b'}
s2 = {'c', 'b'}
s = s1 | s2
print(s)  
</code></pre>    

    The operator <code>|</code> returns a new set that consists of distinct elements from both set1 and set2. Output: {'b', 'c', 'a'}
  </ul>
</section>

<section id="4"><h1>Structure</h1>
  <ul>
    <li><code>__init__.py</code></li>
    [<a href="https://bit.ly/3FpJ3cK">Ref</a>] An old way of doing things to mark modules that come under a particular namespace. The namespace here is the name of the folder that the script is placed in. By modules, I mean, anything we want to import - functions, classes or files.
  </ul>
</section>

<section id="5"><h1>List</h1>
  <subsection id="5.0"><h1>List of numpy arrays</h1>
    The following is a list of 2 elements; each being a numpy array.
<pre><code class="python">
temp = 
[
  np.array([
            [1, 0, 0, 1]
            [0, 1, 0, 0]
            [0, 0, 1, 1]
            [0, 0, 0, 1]]),
  np.array([
            [1, 0, 0, 1]
            [0, 1, 0, 0]
            [0, 0, 1, 1]
            [0, 0, 0, 1]])
]
</code></pre>

    <p>
      I can then create an empty list and add this list to it.
      Every time <code>append</code> is used, a new list is added
      to the existing list as a new row.
    </p>
    <pre class="highlight">
      <code>trajs = list()
trajs.append(temp)
trajs.append(temp)
print('{0}, {1}, {2}'.format(len(trajs), len(trajs[0]), trajs[0][0])</code></pre>

    <p>
      {0} - Number of elements within the list 'trajs'. 
      There are 2 lists.
      <br>
      {1} - Number of elements within the first element of 'trajs'. 
      The first element of 'trajs' is a list containing 2 numpy arrays.
      <br>
      {2} - prints out the 1st numpy array.
    </p>
  </subsection>
</section>

<section id="6"><h1>Python learning from Drake python api</h1>
  <ul>
    <li>Random number generator</li>
    <a href="https://t.ly/di5q">Here's</a> a stackoverflow post to encourage looking
    into <code>RandomState</code> a bit more.
<pre><code class="python">
random_state = np.random.RandomState(seed)
# Constructs a random number generator. And then we make the following call to actually
# generate the random numbers <a href="https://t.ly/kbB4">ref</a>:
random_state.rand(nrows, ncols)
# Or generate a single number.
random_state.rand()
</code></pre>

    <li>Array with evenly spaced elements</li>
<pre><code class="python">
np.arange(start, end, interval_between_each_element)
</code></pre>

    <li>Stack arrays vertically</li>
<pre><code class="python">
outputArray = np.vstack(array1, array2)
</code></pre>
  </ul>
</section>

<section id="7"><h1>Pandas</h1>
  <ul>
    <li>Convert group of numpy arrays into a pandas dataframe</li>
<pre><code class="python">
test = np.vstack([w,h]).T
test.shape
df = pd.DataFrame(test, columns=['w', 'h'])

# If w and h are just 2 arrays with n rows each, when vertically stacked,
# the array turns into a (2xn) array. We have to then transpose it to get
# to a column major form.
</code></pre>    
    <p></p>
    
    <li>Pandas datetime properties</li>
    <a href="https://t.ly/5Mvv">This</a> seems useful.
    <p></p>

    <li>Find all rows of a particular column that are nans</li>
<pre><code class="python">
df = df['colName']
df[pd.isna(df)].index
</code></pre>

    <li>Appending to a dataframe is expensive</li>
    Use lists instead - <a href="https://bit.ly/3Fg5Ve3">Ref</a>.

    <p>
      <li>Find the index of the max value of a particular column</li>
<pre><code class="python">
df['columnName'].idxmax()
</code></pre>
    </p>

    <li>Creating a dataframe from a dictionary but with a twist</li>
    If there are 2 columns A and B, and I want 3 rows in A with different entries, 
    but the same corresponding row entry in B:
<pre><code class="python">
l = ['a1', 'a2', 'a3']
temp = pd.DataFrame({'A':l,
                     'B':'test'})
</code></pre>
  </ul>
</section>

<section id="8"><h1>Numpy</h1>
  <ul>
    <li><code>@</code> is the same as <code>np.dot</code></li>
    <li>Create a 2d array with zeros</li>
<pre><code class="python">
test = np.zeros((nrows, ncols))  
</code></pre>

    <p>
      <li>Create an empty array</li>
<pre><code class="python">
test = np.empty(N)
</code></pre>    
    </p>
    <p>
      <li>Create a 2d array</li>
<pre><code class="python">
# Outer square brackets are needed.
# 2nd pair of square brackets indicate an individual row.
# Rows are separated by a comma.
# Output of x.shape: (1,5)
x = np.array([[1, 2, 3, 4, 5]])

# Output of x.shape: (5,)
# Not a 2d array; no 2nd pair of []s.
x = np.array([1, 2, 3, 4, 5])

# Output of x.shape: (5,1)
x = np.array([[1, 2, 3, 4, 5]]).T

# Alternative. x is no longer of type array but numpy.matrix.
x = np.mat([1, 2, 3, 4, 5]).T

# To convert from matrix to array type
np.asarray(x)
</code></pre>
    </p>

    <li>Operations with numpy arrays</li>
    We can use operations like <code>.shape</code>, <code>.T</code>,
    but <code>type()</code> is not an attribute of the numpy array class,
    hence we can't do <code>.type</code>. Similarly, converting numpy matrix
    back to an array - <code>asarray</code> is not an attribute of the matrix class.

    <p>
      <li>Accessing elements of an array</li>
      If H is a 2d array with 3 rows and 3 columns.
<pre><code class="python">
H = np.array([[1,2,3],
              [4,5,6],
              [7,8,9]])
# To access all rows of the 3rd column.
H[:, -1]  

# To access 2nd row of the 1st column.
H[1,-3]
</code></pre>      
    </p>
  </ul>
</section>

<section id="9"><h1>General</h1>
  <ul>
    <li>For loop to iterate through list with indices</li>
    <a href="https://t.ly/SLyk">Ref</a>.
<pre><code class="python">
  for i, f in enumerate(freq):

  # i will contain the indices from 0 to len(freq)-1
</code></pre>

    <li>Another way of writing a for loop</li>
    The normal way:
<pre><code class="python">
  filteredFreq = np.empty(len(freq))

  for i, f in enumerate(freq):
    if (fpass-50 < i < fpass+50):
      if (f > 1):
        filteredFreq[i] = f
      else:
        filteredFreq[i] = 0
    else:
      filteredFreq[i] = 0
</code></pre>

    The condensed form:
<pre><code class="python">
  filteredFreq = np.array([f if (fpass-50 < i < fpass+50 and f>1) else 0 for i, f in enumerate(freq)])
</code></pre>
  </ul>
</section>

<section id="10"><h1>Regular expressions</h1>
  <ul>
    <li>Substitute</li>
<pre><code class="python">
line = ',{"test":"2022-11-07T14:55:14","source":"water","test2":{ "type": "success"}'
temp = re.sub(pattern=r'^.*{ "type"', repl='{"type"', string=line)

Output: {"type": "success"}
</code></pre>
    <code>^</code> - from the start of the string.
    <br>
    <code>.*</code> - match all characters except newline as many times as possible.
    <br><br>

    <li>Search</li>
<pre><code class="python">
line = ',{"test":"2022-11-07T14:55:14","source":"water","test2":{ "type": "success"}'
ts = re.search(r'{(.*),"source"', line).group(1)

Output: "test":"2022-11-07T14:55:14"
</code></pre>
    The starting '{' is just to indicate where we want to begin the search from.
    <br>
    <code>group(0)</code> - contains the string considered for the search.
    <br>
    <code>group(1)</code> is the portion represented in between the brackets using wildcards.
    
    <p>
      <li>Pick the last word after a given pattern is found</li>
<pre><code class="python">
line = 'Blah AS type'
temp = re.search(r'^.*AS (\w*)', line, flags=re.IGNORECASE)
if temp != None:
  temp = temp.group(1)

Output: type
</code></pre>
      <code>\w</code> - returns a character. The asterisk picks the repetition of characters. No specific characters
      mentioned here.
      <br>
      With <code>IGNORECASE</code>, 'AS' can be lower or uppercase.
    </p>
  </ul>  
</section>

<section id="11"><h1>Lambda</h1>
  <ul>
    <li>Sorting</li>
<pre><code class="python">
  sorted(input, key=lambda item: item[1]) 
</code></pre>    
    
    <code>input</code> is a list of tuples. <code>Tuples</code> are used to 
    store multiple items in a single variable.
    An example:
<pre><code class="python">
  Example for input:
  [
    ('test1', 1),
    ('test2', 2)
  ]
</code></pre>   
    More info on <code>sorted</code>, how it uses a key to decide the sorting
    order - <a href="https://t.ly/E1z-">Ref</a>. Nice to see how a function can 
    also be a key which leads well into a discussion on lambdas.

    <p>
      <code>Lambda</code> signifies an anonymous function. Here, it takes as input 
      (<code>item</code>) each tuple from the list of tuples and returns the 
      2nd element of each tuple. Some info on lambdas is
      <a href="https://t.ly/xnN7">here</a>. Here, <code>sorted()</code>
      breaks the list of tuples down into individual tuples and passes each one
      to the lambda function to retrieve the key for sorting.
    </p>
  </ul>
</section>

<section id="12"><h1>Dictionary</h1>
  <ul>
    <li>.items()</li>
<pre><code class="python">
  a = {'t1':0, 't2':1, 't3':2}
  print(a.items())
  for i in a.items():
    print(i)

  Output:
  dict_items([('t1', 0), ('t2', 1), ('t3', 2)])
  ('t1', 0)
  ('t2', 1)
  ('t3', 2)
</code></pre>    
    <code>.items()</code> splits a dictionary into a list of (key,value) tuples that
    we can iterate over.
    <p></p>

    <li>groupby and groups</li>
<pre><code class="python">
  df.groupby('columnName').groups
</code></pre>    
    This returns each unique row entry in the specific column as a dictionary with 
    the 'row field name' as the key and the 'indices of occurrences' as the value.

<pre><code class="python">
  df.groupby('columnName').groups.items()
</code></pre>    
    This returns a list of tuples where each tuple is a pair containing 
    (unique field name, list of indices of occurrences). We can now iterate
    over this.

<pre><code class="python">
  pd.DataFrame([[ev, index.values] for ev, index in df.groupby('eventType').groups.items()],\
                columns=['eventType', 'indices'])
</code></pre>
    'index' is a list of indices of occurrences of the particular row-event. But 
    it is of type <code>'pandas.core.indexes.numeric.Int64Index'</code> which is 
    converted to <code>numpy.ndarray</code> so we can use it as a list of ints.
  </ul>
</section>

<section id="13"><h1>Timing python code</h1>
<pre><code class="python">
python -mtimeit "import numpy as np; a = np.empty((100,100));" "a.fill(np.nan)"
</code></pre>  
</section>

<section id="14"><h1>Relationships</h1>
  <subsection id="14.0"><h1>Extension (Inheritance)</h1>
    Inheritance is a mechanism by which a class inherits properties and behaviors (attributes and methods) from another class. It is used to model an "is-a" relationship, where a derived class is a specialized version of the base class.

<pre><code class="python">
class Animal:
  def speak(self):
      pass

class Dog(Animal):
  def speak(self):
      return "Woof!"
</code></pre>    
  </subsection>

  <subsection id="14.1"><h1>Composition</h1>
    Composition is a design principle where a class contains objects of other classes as part of its attributes, to achieve some functionality, and the relationship is referred to as a "has-a" relationship.
<pre><code class="python">
class Engine:
  def start(self):
      pass

class Car:
  def __init__(self):
      self.engine = Engine()

  def start_engine(self):
      self.engine.start()
</code></pre>    
      
  </subsection>

  <subsection id="14.2"><h1>Aggregation</h1>
    Aggregation is similar to composition but with a key difference - the contained objects have an independent lifecycle, can exist outside the container and can be shared among multiple containers. It represents a "has-a" relationship without strong ownership.

<pre><code class="python">
class Department:
  def __init__(self, name):
      self.name = name

class University:
  def __init__(self):
      self.departments = []

  def add_department(self, department):
      self.departments.append(department)
</code></pre>    
      
  </subsection>
</section>

<section id="15"><h1>Set</h1>
  A set is an unordered collection of unique elements defined using <code>{}</code> or the <code>set()</code> constructor. Sets do not allow duplicate elements, and the order of elements is not guaranteed, i.e. they don't support indexing and hence indices cannot be used to access elements in a set. The presence of an element within a set can be checked using the <code>in</code> keyword.

<pre><code class="python">
my_set = {1, 2, 3, 4, 5}
element_to_check = 3
if element_to_check in my_set:
  print('True')
</code></pre>
</section>

<section id="16"><h1>Musings</h1>
  <ul>
    <li>What does <code>enumerate</code> in a for loop do?</li>
    <a href="https://t.ly/txYV">Ref</a>.
    <br><br>

    <li>','.join(list), list.extend(['a','b']), list.copy()</li>
  </ul>
</section>

</chapter>

</body>
</html>
