
<!DOCTYPE html>
<html>
<head>
  <title>Update step</title>
  <meta name="Update step" content="text/html; charset=utf-8;" />
  <script type="text/javascript" src="../../../../../../logbook.js"></script>

  <script src="../../../../../../logbook-mathjax-config.js" defer></script> 
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
  <script> mermaid.initialize({startOnLoad: true}); </script>  

  <link rel="stylesheet" type="text/css" href="../../../../../../logbook.css" />
</head>

<body onload="loadChapter('');">  

  <div data-type="titlepage" pdf="no">
    <header>
      <h1><a href="../../../../../../index.html" style="text-decoration:none;">Logbook</a></h1>
      <p style="font-size: 18px;"><a href="../../../../../../bio.html">Jayson Wynne-Thomas</a></p>
      <p style="font-size: 14px; text-align: right;"> 
        Last modified <span id="last_modified"></span>.</br>
        <script>
        var d = new Date(document.lastModified);
        document.getElementById("last_modified").innerHTML = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();</script>
      </p>
    </header>
  </div>
  
  <div id="main" class="sidebar1">
    <span style="font-size:10px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

  <div id="mySidenav" class="sidebar">
  
<a href="#0">Overview</a>
<a href="#1">Kalman gain</a>
<a href="#2">Estimate update</a>
<a href="#3">Covariance upate</a>
</div>

<chapter style="counter-reset: chapter 0"><h1>Update step</h1>

<section id="0"><h1>Overview</h1>
  For every new measurement $y_k$, the <i>measurement gain</i> $K_k$ is computed and used to update the:
  <ul>
    <li><a href="#1">State estimate</a> (the filter's best guess of the current state).</li>
    <li><a href="#2">Covariance of the estimate</a> (which represents the uncertainty in the state estimate).</li>
  </ul>
</section>

<section id="1"><h1>Kalman gain</h1>
  $$
    K_k = P_{k-1}H^T_k(H_kP_{k-1}H^T_k + R_k)^{-1}
  $$

  $K$ becomes smaller when <a href="noiseModel.html">measurement noise</a> $R$ is large, meaning the filter places less weight on the measurement (i.e., it's less confident in the measurements <m>compared to the prediction</m>, see <a href="#2">estimate update step</a>).

  <p>
    A large $K$ implies that a new measurement provides valuable information, which justifies reducing the covariance.
  </p>
</section>

<section id="2"><h1>Estimate update</h1>
  A linear recursive estimate $\hat{x}$, at time $k$, is a linear combination of:
  <ul>
    <li>The previous estimate (best guess so far) and</li>
    <li>The <i>current measurement residual</i> (error difference between expected and the actual measurement) <n>weighted</n> by a gain matrix $K_k$</li>
  </ul>

  $$\begin{equation} \label{eq:linearRecursiveFormulation}
    \hat{x}_k = \hat{x}_{k-1} + 
    \underbrace{K_k}_{\text{Estimator} \atop \text{gain matrix}}
    \underbrace{(y_k - H_k\hat{x}_{k-1})}_{\text Innovation}
  \end{equation}$$

  The residual quantifies how well the current measurement matches the previous best estimate. <n>If it is $0$, the old estimate does not need to be updated</n>.
</section>

<section id="3"><h1>Covariance upate</h1>
  $$
    P_k = (I-K_kH_k)P_{k-1}
  $$
  <div style="width:0; text-align:left;">
    $$\begin{array}{ccl} 
      P_k &:& \text{Updated (posterior) state covariance matrix after incorporating the measurement at time $k$} \\ 
      P_{k-1} &:& \text{Predicted (prior) covariance matrix before incorporating the measurement} \\
      I &:& \text{Identity matrix}
    \end{array}$$
  </div>

  Every time a new measurement is taken, the uncertainty should shrink (confidence in the updated estimate should increase) with higher Kalman gain value and lower posterior covariance value. The magnitude of this reduction depends on the relative uncertainties of the model prediction and the measurement.
</section>
</chapter>

</body>
</html>
