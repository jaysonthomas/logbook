<!DOCTYPE html>
<html>
<head>
  <title>3D Drone dynamics: Moments</title>
  <meta name="3D Drone dynamics: Moments" content="text/html; charset=utf-8;" />
  <script type="text/javascript" src="../../../../../../../logbook.js"></script>

  <script src="../../../../../../../logbook-mathjax-config.js" defer></script> 
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
  <script> mermaid.initialize({startOnLoad: true}); </script>  

  <link rel="stylesheet" type="text/css" href="../../../../../../../logbook.css" />
</head>

<body onload="loadChapter('');">  

  <div data-type="titlepage" pdf="no">
    <header>
      <h1><a href="../../../../../../../index.html" style="text-decoration:none;">Logbook</a></h1>
      <p style="font-size: 18px;"><a href="../../../../../../../bio.html">Jayson Wynne-Thomas</a></p>
      <p style="font-size: 14px; text-align: right;"> 
        Last modified <span id="last_modified"></span>.</br>
        <script>
        var d = new Date(document.lastModified);
        document.getElementById("last_modified").innerHTML = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();</script>
      </p>
    </header>
  </div>
  
  <div id="main" class="sidebar1">
    <span style="font-size:10px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

  <div id="mySidenav" class="sidebar">
  
<a href="#0">Overview</a>
<ul class="no-bullets">
  <li><a href="#0.0">World frame</a></li>
  <li><a href="#0.1">Body frame</a></li>
</ul>
<a href="#1">Moment of inertia</a>
<a href="#2">Rotational equilibrium</a>
<a href="#3">Moments in the body frame</a>
</div>

<chapter style="counter-reset: chapter 0"><h1>3D Drone dynamics: Moments</h1>
<section id="0"><h1>Overview</h1>
  $$
    M_z = I_z \ddot{\psi}
  $$
  
  This equation says that a moment about an axis will cause a rotational acceleration about that axis. In 2d, all of these variables are just scalar numbers. 

  <subsection id="0.0"><h1>World frame</h1>
    In 3D, the equation changes:
    $$
      \underbrace{\begin{bmatrix}
        M_x \\ M_y \\ M_z
      \end{bmatrix}}_{M_{3 \times 1}} = I_{3 \times 3} 
      \underbrace{\begin{bmatrix}
        \dot{p} \\ \dot{q} \\ \dot{r}
      \end{bmatrix}}_{\dot{\omega}_{3 \times 1}}
    $$
 
    This equation is only valid in the world frame. But, gyros measure rotation rates about the body frame's axis and hence a drone's moments are more naturally computed relative to the body frame. The diagonal of the moment of inertia matrix is only a nice constant in the body frame.
  </subsection>

  <subsection id="0.1"><h1>Body frame</h1>
    Using Euler's equation in a rotating frame, it is possible to work in the body frame. There is an additional term, the cross product of 2 vectors, $\omega$ and $I\omega$.

    <p>
      $$
        M = I\dot\omega + \omega \times (I\omega)
      $$
      $\omega = \begin{bmatrix} p \\ q \\ r \end{bmatrix}$
    </p>
  </subsection>

</section>

<section id="1"><h1>Moment of inertia</h1>
  For a 3D quadrotor motion, the moment of inertia will be a $3\times 3$ matrix summarising all moments of inertia. It is easier to think about one axis of rotation at a time. 

</section>

<section id="2"><h1>Rotational equilibrium</h1>
  In a quadrotor, the propellers are placed in a configuration where adjacent rotors always spin in opposite directions - whilst all rotors provide an upward thrust, one set rotates clockwise and the other CCW. 
  
  <p>
    A drone has no rotation or yaw when all its rotors are spinning at the same rate such that CW torques exactly balance CCW torques. When the CW rotors spin faster than the CCW ones, the CCW moment produced by those CW rotors dominates, causing the drone to yaw in the CCW direction.
  </p>
</section>

<section id="3"><h1>Moments in the body frame</h1>
  Differential thrusts are used to advance the rotational motion.
  <div class="container">
    <figure>
      <img style="height:120px; width:auto"
      src="../../../../../../figures/drone/47a_frame.png"/>
    </figure>
    <figure>
      <img style="height:120px; width:auto"
      src="../../../../../../figures/drone/47b_frame.png"/>
    </figure>
  </div> 

  <subsubsection><h1>Roll</h1>
    Moments generated by propellers 1, 4 are counteracted by those generated by propellers 2, 3. 
    $$
      \tau_x = \Big(|F_1| + |F_4| - |F_2| - |F_3|\Big)l
    $$
  </subsubsection>
  
  <subsubsection><h1>Pitch</h1>
    Mismatch of moments created by propellers 1, 2 vs propellers 3, 4.
    $$
      \tau_y = \Big(|F_1| + |F_2| - |F_3| - |F_4|\Big)l
    $$
  </subsubsection>

  <subsubsection><h1>Yaw</h1>
    Mismatch of <n>reactive</n> moments generated by the propellers about the z-axis. A reactive moment generated by a propeller is directed in the opposite direction to that of its rotation and is proportional to the square of the angular velocity.

    $$
      \tau_z = \tau_1 + \tau_2 + \tau_3 + \tau_4
    $$
    $$\begin{align*}
      \tau_1 &= -k_m \omega_1^2 \\
      \tau_2 &= k_m \omega_2^2 \\
      \tau_3 &= -k_m \omega_3^2 \\
      \tau_4 &= k_m \omega_4^2 \\
    \end{align*}$$

    In the notation here, propellers 1, 3 rotate in the CW direction thus producing reactive moments in the CCW direction with negative signs.
  </subsubsection>
</section>
</chapter>

</body>
</html>
