<!DOCTYPE html>
<html>
<head>
  <title>Taylor series approximation</title>
  <meta name="Taylor series approximation" content="text/html; charset=utf-8;" />
  <script type="text/javascript" src="../../../../logbook.js"></script>

  <script src="../../../../logbook-mathjax-config.js" defer></script> 
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
  <script> mermaid.initialize({startOnLoad: true}); </script>  

  <link rel="stylesheet" type="text/css" href="../../../../logbook.css" />
</head>

<body onload="loadChapter('');">  

  <div data-type="titlepage" pdf="no">
    <header>
      <h1><a href="../../../../index.html" style="text-decoration:none;">Logbook</a></h1>
      <p style="font-size: 18px;"><a href="../../../../bio.html">Jayson Wynne-Thomas</a></p>
      <p style="font-size: 14px; text-align: right;"> 
        Last modified <span id="last_modified"></span>.</br>
        <script>
        var d = new Date(document.lastModified);
        document.getElementById("last_modified").innerHTML = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();</script>
      </p>
    </header>
  </div>
  
  <div id="main" class="sidebar1">
    <span style="font-size:10px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

  <div id="mySidenav" class="sidebar">
  
<a href="#0">Overview</a>
<a href="#1">Example</a>
<ul class="no-bullets">
  <li><a href="#1.0">Aim</a></li>
  <li><a href="#1.1">Working out the solution</a></li>
  <li><a href="#1.2">The solution</a></li>
  <li><a href="#1.3">More terms</a></li>
</ul>
<a href="#2">Generalisation</a>
<ul class="no-bullets">
  <li><a href="#2.0">Note 1</a></li>
  <li><a href="#2.1">Note 2</a></li>
  <li><a href="#2.2">Note 3</a></li>
  <li><a href="#2.3">Note 4</a></li>
</ul>
</div>

<chapter style="counter-reset: chapter 3"><h1>Taylor series approximation</h1>
<section id="0"><h1>Overview</h1>
  [<a href="https://t.ly/oxtDJ">Ref1</a>, <a href="https://t.ly/cCCS1">Ref2</a>, <a href="https://t.ly/wT1Ur">Ref3</a>] <br>

  <i>Taylor series</i> helps find polynomials that best approximate non-polynomial functions near some point (an input). 

  <p>
    Polynomials are easier to deal with than other functions since they are easier to:
    <ul>
      <li>Compute</li>
      <li>Take derivatives of</li>
      <li>Integrate</li>
    </ul>
  </p>

  The <i>Taylor polynomial</i> is an approximation of a target function evaluated at some input with finite number of terms. Adding all infinitely many terms gives a <i>Taylor series</i>. In math, an infinite sum is called a <i>series</i>.
  $$
    P(x) = f(0) + \frac{df}{dx}(0)\frac{x^1}{1!} +
           \frac{d^2f}{dx^2}(0)\frac{x^2}{2!} + 
           \frac{d^3f}{dx^3}(0)\frac{x^3}{2!} + \cdots
  $$
  <ul>
    <li>$f(0)$</li>
    The constant term ensures that the value of the taylor polynomial matches the value of the target function at the input point.

    <p>
      <li>$\frac{df}{dx}(0)\frac{x^1}{1!}$</li>
      Ensures that the slope of the polynomial matches the slope of the target function at the input point, here $x=0$.
    </p>

    <li>$\frac{d^2f}{dx^2}(0)\frac{x^2}{2!}$</li>
    Ensures the rate at which the slope changes matches that of the target function at the input point.
  </ul>

  <subsubsection><h1>Taylor polynomial at an input $a$</h1>
    $$
      P(x) = f(a) + \frac{df}{dx}(a)\frac{(x-a)^1}{1!} +
            \frac{d^2f}{dx^2}(a)\frac{(x-a)^2}{2!} + 
            \frac{d^3f}{dx^3}(a)\frac{(x-a)^3}{2!} + \cdots
    $$
  </subsubsection>
</section>

<section id="1"><h1>Example</h1>
  <subsection id="1.0"><h1>Aim</h1>
    Near $0$, the taylor approximation for $cos\theta$ (which is a quadratic in this case) is close.
    <div class="container">
      <figure>
        <img style="height:85px; width:auto"
        src="../../../../figures/maths/6_taylorSeriesCosine.png"/>
        <figcaption>
          $\color{blue}{cos\theta} \approx \color{green} 1-\frac{1}{2}\theta^2$
        </figcaption>
      </figure>
    </div>

    Given a polynomial, $P(x) = c_0 + c_1x + c_2x^2$, the aim is to find the best constant values that makes the polynomial closely resemble $cos(x)$ at a given point/input, say $x=0$.
  </subsection>

  <subsection id="1.1"><h1>Working out the solution</h1>
    <subsubsection><h1>$c_0$</h1>      
      The polynomial needs to have the same value as the non-polynomial function at the point of interest. All constants are allowed to change at this point.

      $$\begin{align*}
        cos(x=0) &= 1 \\
        P(x=0) &= c_0 + c_10 + c_20^2 \\
            &= c_0 \\
            &= 1
      \end{align*}$$

      $c_0$ is set to $1$ for $P(x=0)$ to be equal to $cos(x=0)$.
    </subsubsection>
    <subsubsection><h1>$c_1$</h1>
      The polynomial needs to have the same tangent slope at the point of interest, else the approximation drifts away from the
      cosine graph much faster than it needs to. Only $c_1, c_2$ are free to change.

      <figure>
        <img style="height:85px; width:auto"
        src="../../../../figures/maths/6b_taylorSeriesCosineTangent.png"/>
        <figcaption>
          Tangent or slope at the point of interest
        </figcaption>
      </figure>

      $$\begin{align*}
        \frac{d}{dx}cos(x=0) &= -sin(0) \\ 
                            &= 0 \\
        \frac{dP}{dx}(x=0) &= c_1 + 2c_2x \\
                          &= c_1 + 2c_2(0) \\
                          &= 0
      \end{align*}$$

      The constant $c_1$ has complete control over the derivative of the approximation around $x = 0$. Setting it equal to $0$ ensures that the approximation also has a flat tangent line at this point.
    </subsubsection>
    <subsubsection><h1>$c_2$</h1>
      Only $c_2$ is allowed to change; the rest are locked to match the value and the slope of the target function at the input. The cosine graph curves downward around $x = 0$, i.e. it has a negative second derivative. In other words, even though the rate of change is $0$ at the input, the rate of change itself is decreasing around that point.

      <figure>
        <img style="height:85px; width:auto"
        src="../../../../figures/maths/6c_taylorSeriesCosine2ndDerivative.png"/>
        <figcaption>
          Second derivative at the point of interest
        </figcaption>
      </figure>

      Making sure that the second derivatives match will ensure that the functions curve at the same rate; that the slope of the taylor polynomial doesn't drift away from the slope of the target function any more quickly than it needs to.

      $$\begin{align*}
        \frac{d^2}{dx}cos(x=0) &= -cos(0) \\ 
                              &= -1 \\
        \frac{d^2P}{dx^2}(x=0) &= 2c_2 \\
                              &= -1 \\
                            c_2 &= -\frac{1}{2}
      \end{align*}$$
    </subsubsection>
  </subsection>

  <subsection id="1.2"><h1>The solution</h1>
    $$
      P(x) = c_0 + c_1x + c_2x^2
    $$

    <ul>
      <li>
        $c_0$ is responsible for making sure that the output of the approximation matches that of $cos(x)$ at $x=0$.
      </li>
      <li>
        $c_1$ is in charge of making sure that the derivatives matches at the input.
      </li>
      <li>
        $c_2$ is responsible for making sure that the second derivatives match up.
      </li>
    </ul>

    This ensures that the approximation and the rate of change itself, changes, is as similar as possible to the behaviour of $cos(x)$.
  </subsection>

  <subsection id="1.3"><h1>More terms</h1>
    More terms could be used in the polynomial to control higher order derivatives. 

    $$\begin{array}{ccc}
      \begin{aligned}
        \frac{d^3}{dx^3}\cos(x)\bigg|_{x=0} &= \sin(0) \\ 
                                          &= 0 \\
        \frac{d^3}{dx^3}P(x)\bigg|_{x=0} &= 6c_3 \\
                              &= 0 \\
                          c_3  &= 0
      \end{aligned}
      &&
      \begin{aligned}
        \frac{d^4}{dx^4}\cos(x)\bigg|_{x=0} &= \cos(0) \\ 
                                            &= 1 \\
        \frac{d^4}{dx^4}P(x) \bigg|_{x=0} &= 24c_4 \\
                              &= 1 \\
                          c_4  &= \frac{1}{24} 
      \end{aligned}
    \end{array}$$

    Taking the cubic derivative of the above polynomial yields $6c_3$, but this can be re-written as the factorial of the corresponding power of $x$ in the polynomial, since after each iteration of the power rule, the result looks as follows:

    $$\begin{align*}
      P(x) &= c_0 + c_1x + c_2x^2 + c_3x^3 \\
      \frac{d}{dx}P(x) &= c_1 + 2c_2x + \textcolor{red}3c_3x^2 \\
      \frac{d^2}{dx^2}P(x) &= 2c_2 + \textcolor{red}{3 \cdot 2}c_3x^1 \\
      \frac{d^3}{dx^3}P(x) &= \textcolor{red}{3 \cdot 2 \cdot 1}c_3x^0 \\
    \end{align*}$$
  
    Similarly, the 4th derivative of the polynomial yields $4!c_4x^0$. To match the 4th derivative of $cos(x)$, $c_4$ needs to be $\frac{1}{24!}$. This is a very close approximation of $x$ at $x=0$.
  </subsection>
</section>

<section id="2"><h1>Generalisation</h1>
  <subsection id="2.0"><h1>Note 1</h1>
    The coefficient of the nth power of $x$ in a taylor polynomial is equal to the value of the nth derivative of the target function, divided by $n$ factorial:
    $$
      c_n = \frac{\text{Desired derivative value}}{n!}
    $$
  </subsection>

  <subsection id="2.1"><h1>Note 2</h1>
    Adding extra coefficients to the polynomial doesn't affect the terms before it, since the higher power terms disappear when a lower power derivative of the polynomial is taken. Hence, each coefficient controls one and only one derivative.

    <figure>
      <img style="height:85px; width:auto"
      src="../../../../figures/maths/6d_TaylorSeriesControls.png"/>
    </figure>
  </subsection>

  <subsection id="2.2"><h1>Note 3</h1>
    To approximate near an input other than 0, like $x = \pi$, the polynomial would have to be written in terms of powers of $x - \pi$. This makes it complicated but the goal is to make the point $\pi$ behave like $0$, so that plugging in $x = \pi$ results in a lot of nice cancellation that leaves only one constant.

    $$
      P_\pi(x) = c_0 + c_1(x - \pi)^1 + c_2(x - \pi)^2 + c_3(x-\pi)^3
    $$
  </subsection>

  <subsection id="2.3"><h1>Note 4</h1>
    Higher order derivatives of the target function is taken at a single point, to get information about the value of the function near that point.
  </subsection>
</section>
</chapter>

</body>
</html>
